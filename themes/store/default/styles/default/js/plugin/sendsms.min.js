$.sendSms=function(b,a){new $.sendSms.prototype.init(b,a);};$.sendSms.prototype={constructor:$.sendSms,startTime:new Date()-0,inTest:/^\/category-shafa\//.test(location.pathname)&&!/\/goods-\d+\.html/.test(location.pathname),bg:"http://web/images/zhuanti/upload/a_1374111909_1394422393.png",styleInserted:false,title:{exprAddress:"免费发送体验馆地址到手机",get_out_goods:"免费发送特卖信息到手机",getPrize:"体验馆抽奖",get_prize_all:"手机抽奖"},init:function(b,a){if($._currentSendSmsBox){$._currentSendSmsBox.remove();}if(this.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","初始"]);}this.setting=$.extend({type:"exprAddress",phoneNumber:false,autoSend:false,autoClose:false,checkPhone:false,defaultCityId:parseInt($.cookie("region_id"))},a);if(b==false&&this.setting.exprInfo&&this.setting.exprInfo.exprList&&this.setting.exprInfo.exprList.length==1){b=this.setting.exprInfo.exprList[0].exprId;delete this.setting.exprInfo;}this.exprId=b;this.setStyleRule();this.dom=this.show();$._currentSendSmsBox=this;if(this.inTest){$($._currentSendSmsBox.dom).animate({top:($(window).height()-440)/2+"px"});}if(!this.exprId&&this.setting.exprInfo){this.insertExprSelect();}else{if(!this.exprId&&!this.setting.exprInfo){this.insertCitySelect();}}this.msgBox=$("#_JS_sndSms_msg_box_");this.inpt=$("#_JS_sndSms_input_");this.btn=$("#_JS_sndSms_btn_");this.captcha=$("#_JS_sndSms_captcha_");this.captchaImg=$("#_JS_sndSms_captchaImg_");this.cellcaptcha=$("#_JS_sndSms_prz_cellcaptcha_");this._mobile_captcha_times_limit_g=window._mobile_captcha_times_limit||120;if(this.setting.checkPhone){this.setting.flag=0;this.setting.pNumber=0;this.insertCellCaptcha();this.inpt.on("blur",$._currentSendSmsBox.hiddenPhone);this.inpt.on("focus",$._currentSendSmsBox.value_null);$("#_JS_sndSms_prz_cellcaptcha_").on("change",$._currentSendSmsBox.checkCellCaptcha);this.cellcaptcha_flag=false;}if(this.setting.phoneNumber){$._currentSendSmsBox.hiddenPhone();}if(this.setting.phoneNumber&&this.setting.autoSend){this.send();}this.getCaptcha(this.setting.captchaSrc);this.captcha_flag=false;this.captcha_icon=$("#_JS_sendSms_captcha_icon");$.checkCaptcha(this.captcha,{success:function(){var c=$._currentSendSmsBox.captcha_icon;c.addClass("sms_captcha_success");c.removeClass("sms_captcha_error");$._currentSendSmsBox.captcha_flag=true;if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","验证验证码成功"]);}},error:function(){var c=$._currentSendSmsBox.captcha_icon;c.removeClass("sms_captcha_success");c.addClass("sms_captcha_error");$._currentSendSmsBox.captcha_flag=false;if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","验证验证码失败"]);}}});},setStyleRule:function(){if(!this.styleInserted){var a=[];var b;a.push(".sms_box {width:440px;padding-bottom:20px;border:5px solid #aaa;border-color:rgba(170,170,170,.8);background:#fff;margin:0px auto;overflow:hidden;}");a.push(".sms_title_box{height:40px;line-height:40px;border-bottom:1px solid #dedede;padding-left:32px;color:#333;background:#f1f1f1 url("+this.bg+") -56px -62px no-repeat;}");a.push(".sms_content {padding-top:19px;}");a.push(".sms_content .red {color: #c9033b;line-height:22px;}");a.push(".sms_input {width:205px;height:28px;background: #fafafa;border:1px solid #ddd;border-radius: 2px;padding:0;margin:0;color:#555;padding-left:5px;line-height:28px;}");a.push("._sms_shadow:focus{transition:border linear .2s,box-shadow linear .2s;-moz-transition:border linear .2s,-moz-box-shadow linear .2s;-webkit-transition:border linear .2s,-webkit-box-shadow linear .2s;outline:none;border-color:#6db9e0;box-shadow:0 0 4px #7fcaf1;-moz-box-shadow:0 0 4px #7fcaf1;-webkit-box-shadow:0 0 4px #7fcaf1;}");a.push(".sms_captcha {width:34px;height:28px;background: #fafafa;border-radius: 2px;border:1px solid #ddd;padding:0;margin:0;vertical-align:top;color:#555;padding-left:5px;line-height:28px;}");a.push(".sms_content label {height:28px; line-height: 28px;width:128px;text-align:right;display:inline-block;vertical-align:top;}");if(this.exprId){a.push(".sms_content label{width:120px;}");}a.push(".sms_submit {height:31px;background:#fff url("+this.bg+") 0 0;width:81px;color:#fff;text-align:center;border:none;margin:0;padding:0;font-weight:bold;}");a.push(".sms_refresh {height:31px;background:#fff url("+this.bg+') 0 -104px;width:130px;color:#333;text-align:center;border:none;margin:0;padding:0;font:14px/30px "Microsoft Yahei";}');a.push(".sms_submit:hover {background-position: 0 -31px;}");a.push("._selectbox{background: #fafafa;display:inline-block;padding-top:4px;border:1px solid #ddd;height:24px;margin-bottom:12px;padding-right:5px;margin-right:4px;*border:none;}");a.push("._sndsms_select{background: #fafafa;border:none;margin:0;margin-bottom:10px;width:207px;}");a.push("#_JS_sndSms_city_list_,#_JS_sndSms_province_list_{width:95px;}");a.push("._check_icon{display:inline-block;height:16px;width:15px;margin-top:9px;}");a.push(".sms_captcha_success{background:url("+$.__IMG+"/images/check_icon8.png) 0 -8px no-repeat}");a.push(".sms_captcha_error{background:url("+$.__IMG+"/images/check_icon8.png) 0 -30px no-repeat}");a.push(".prz_input {width:200px;height:28px;border:1px solid #c7c7c7;padding:0;margin:0;vertical-align:top;color:#555;padding-left:5px;line-height:28px;}");a.push(".prz_captcha {width:60px;}");a.push(".prz_yuanjiao {background:#FAFAFA;font-weight:bold;text-align:center;width:40px;font-family:Arial;border:2px solid #ccc;border-radius:5px;padding:6px 6px;display:inline-block;margin-left:10px;}");a.push(".prz_cellcaptcha {width:120px;}");a.push(".prz_yuanjiao2 {width:55px;color:#888888;}");a.push(".prz_sure_inline{display:inline-block;}");a.push(".prz_sure {margin-left:10px;width:100px;height:20px;padding-top:8px;color:#0099CC;display:none;}");a.push(".prz_yuanjiao3 {width:100px;color:#999999;display:none;}");a.push(".prz_yuanjiao5 {width:136px;color:#999999;display:none;margin-left:5px;}");a.push(".sms_content .twoDimensionCodeStage{width:367px;border-top: dotted 1px #e1e1e1;margin:10px auto 0 auto;padding-top:15px;text-align:center;}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode {height:82px;padding:0 11px;margin:0 auto;overflow:hidden;}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{display:inline-block;padding-left:10px;height:82px;}");a.push(".sms_close_btn{font-size:18px;color:#909090;font-weight:bold;}");a.push(".sms_msg_box{color:#454545;padding:10px 20px 0 20px;text-align:center}");if(this.inTest){a.push(".sms_box{width:558px;border:1px solid #ff9eb8;padding-bottom:0;}");a.push(".sms_title_box{background:url(http://web/images/201405/1400125167109.jpg) 0 0 no-repeat;height:50px;padding-top:17px;padding-left:55px;font-weight:bold;border-bottom:none}");a.push(".sms_content label,.sms_content option,.sms_content select{color:#333;}");a.push(".sms_content label{font-size:14px;font-family:微软雅黑}");a.push(".sms_submit,.sms_submit:hover{width:112px; height:34px;background:url(http://web/images/zhuanti/upload/smd_1399358138.jpg) 0 0 no-repeat}");a.push(".sms_content .twoDimensionCodeStage {width:auto;background:#fff8ee url(http://web/images/zhuanti/upload/h4_1398411049.jpg) 0 0 repeat-x;border-top:none}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode{height:auto;padding-bottom:10px;}");a.push(".sms_main_box{height:210px;}");a.push('.sms_close_btn{font-size:26px;color:#b3b3b3;font-weight:bold;padding-right:5px;font-family: "宋体";}');a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{height:74px;}");a.push(".sms_content label{width:90px;}");a.push(".sms_msg_box{text-align:left}");a.push("._sndsms_select{width:160px;}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{height:auto;padding-bottom:5px;}");}$.insertStyle(a.join(""));this.styleInserted=true;}},show:function(){var st=this.setting.mobile_default_text||"请输入您的手机号";var str="";var d="";str+='<div class="sms_box" style="">';str+='<div class="clearfix sms_title_box"><div id="_JS_sndSms_title_" class="Left" style="font-size:18px;font-family:微软雅黑;">'+(this.setting.title||this.title[this.setting.type]||"免费发送到手机")+'</div><div class="Right" style="padding-right:10px;"><a class="sms_close_btn" href="javascript:;" onclick="$._currentSendSmsBox.remove();">&times;</a></div></div>';if(this.inTest){var src="http://api.map.baidu.com/staticimage?width=220&height=200&center=中国&zoom=3&copyright=1";str+='<div id="_JS_sndSms_map_" style="width:220px;height:200px;padding:1px;margin-top:19px;border:1px solid #ddd;position:absolute;margin-left:320px"><img src="'+src+'" width="220" height="200" /></div>';}str+='<div class="sms_content" style="">';str+='<div class="sms_main_box">';str+='<div id="_JS_sndSms_city_select_"></div>';str+='<div id="_JS_sndSms_expr_select_"></div>';str+='<div><label for="_JS_sndSms_input_">手机号：</label><input class="sms_input _sms_shadow" value="'+(this.setting.phoneNumber||st)+'" onfocus="if(this.value==\''+st+'\')this.value=\'\'" onkeypress="$._currentSendSmsBox.keyPress(event);" onblur="$._currentSendSmsBox.phoneOnBlur(this);" id="_JS_sndSms_input_" name="_JS_sndSms_input_" /></div>';str+='<div><span id="_JS_sndSms_prz_tishiA" style="margin-left:120px;display:none;"></span></div>';str+='<div style="margin-top:12px;"><label for="_JS_sndSms_captcha_">验证码：</label><input class="sms_captcha _sms_shadow" value="'+(this.setting.captcha||"")+'" onfocus="$._currentSendSmsBox.msgBox.html(\'\');if(this.value==\'验证码\')this.value=\'\'" id="_JS_sndSms_captcha_" name="_JS_sndSms_captcha_" onkeypress="$._currentSendSmsBox.keyPress(event);" ><img src="http://web/themes/paipai/images/blank.gif" style="width:75px;margin-right:5px;height:30px;vertical-align:top;margin-left:8px;cursor:pointer" title="换一张" onclick="$._currentSendSmsBox.getCaptcha();$._currentSendSmsBox._reset_captcha();return false;" id="_JS_sndSms_captchaImg_" /><span class="_check_icon" id="_JS_sendSms_captcha_icon"></span></div>';str+='<div id="_JS_sndSms_cellcaptcha_"></div>';str+='<div style="margin-top:10px;"><label></label><input id="_JS_sndSms_btn_" type="button" style="" class="pointer sms_submit" onclick="$._currentSendSmsBox.send();" value=" " /></div>';str+='<div class="sms_msg_box" id="_JS_sndSms_msg_box_"></div>';str+="</div>";if(window._MCHAT_DATA_SMS_AD_&&window._MCHAT_DATA_SMS_AD_.html_content){try{eval("d="+window._MCHAT_DATA_SMS_AD_.html_content);}catch(e){}}if(this.inTest){d=[{desc:"",src:"http://web/images/201405/1400134686399.jpg",url:"javascript:;"}];}if(d&&d.length){str+='<div class="twoDimensionCodeStage clearfix" id="JS_twoDimensionCodeStage">';str+='<div class="twoDimensionCode">';for(var i=0,ii=d.length;i<ii;i++){if(i==0){str+='<a href="'+d[i].url+'" title="'+d[i].desc+'" style="padding-left:0;">';}else{str+='<a href="'+d[i].url+'" title="'+d[i].desc+'">';}str+='<img src="'+(d[i].src.indexOf("http")===0?"":($.__IMG+"/"))+d[i].src+'" alt="'+d[i].desc+'">';str+="</a>";}str+="</div>";str+="</div>";}str+="</div>";str+="</div>";str+="";window._ana&&window._ana.push(["trackEvent","sendSms_"+this.setting.type,"click",this.setting.phoneNumber||"unset",/^([9]+){3,}$/.test(this.exprId)?"unset":this.exprId]);$.showMask();var tmpBox=$.lightBox(str,{},true);this.setExprMap();return tmpBox;},onlineVideo:function(){if(!parseInt(this.exprId)){$._currentSendSmsBox.msg("请选择离您最近的体验馆。");return false;}$.onlineVideo(this.exprId,{click:"短信弹框_"+this.setting.type});},insertCellCaptcha:function(){str="";str+='<div style="margin-top:10px;"><label>手机校验码：</label>';str+='<input id="_JS_sndSms_prz_cellcaptcha_" class="prz_input prz_cellcaptcha" value="" onfocus="if(this.value==\'手机验证码\')this.value=\'\'" ><span id="_JS_sndSms_prz_btn2_" onclick="$._currentSendSmsBox.getCellCaptcha();" class="pointer prz_yuanjiao prz_yuanjiao2">免费获取</span>';str+='<span id="_JS_sndSms_prz_btn5_" class="prz_yuanjiao prz_yuanjiao5">(0秒后) 重新获取短信</span>';str+='<span id="_JS_sndSms_prz_btn6_" onclick="$._currentSendSmsBox.getCaptchaAgin();" class="pointer prz_yuanjiao prz_yuanjiao3">重发短信校验码</span>';str+="</div>";$("#_JS_sndSms_cellcaptcha_").html(str);},selectedExpr:function(a){$._currentSendSmsBox.exprId=a;if(this.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","选择体验馆",a]);this.setExprMap();}},insertExprSelect:function(){str="";str+='<div><label>体验馆：</label><span class="_selectbox"><select class="_sndsms_select" onchange="$._currentSendSmsBox.selectedExpr(this.value);">';str+='<option value="0">请选择附近体验馆</option>';for(var a=0;a<this.setting.exprInfo.exprList.length;a++){var b="";if(this.setting.exprInfo.exprList.length==1||this.setting.defaultExprId==this.setting.exprInfo.exprList[a].exprId){b=' selected="selected"';this.exprId=this.setting.exprInfo.exprList[a].exprId;this.setExprMap();}str+="<option"+b+' value="'+this.setting.exprInfo.exprList[a].exprId+'">'+this.setting.exprInfo.exprList[a].exprName+"</option>";}str+='</select></span>（<span class="red">'+this.setting.exprInfo.exprList.length+"</span>家）</div>";$("#_JS_sndSms_expr_select_").html(str);this.setting.type=="exprAddress"&&$("#_JS_sndSms_title_").html("发送"+this.setting.exprInfo.cityName+"体验馆地址到手机");},insertCitySelect:function(){var e=this;var b=this.cityInfo;if(b){var d="";d+="<div>";d+="<label>您的位置：</label>";d+='<span class="_selectbox"><select class="_sndsms_select" id="_JS_sndSms_province_list_" onchange="$._currentSendSmsBox.provinceSelected(this.value);">';d+='<option value="0">请选择省</option>';for(var a in b){var f="";if(this.setting.defaultCityId&&b[a]&&b[a].cityList&&b[a].cityList[this.setting.defaultCityId]){f=' selected="selected"';var c=a;}d+='<option value="'+a+'"'+f+">"+b[a].provinceName+"</option>";}d+="</select></span>";d+='<span class="_selectbox" style="margin-left:12px;"><select class="_sndsms_select" id="_JS_sndSms_city_list_" onchange="$._currentSendSmsBox.citySelected(this.value,this.options[this.selectedIndex].innerHTML);"><option value="0">请选择市</option></select></span>';d+="</div>";$("#_JS_sndSms_city_select_").html(d);if(c){this.provinceSelected(c);}}else{this.lock=true;$("#_JS_sndSms_city_select_").html('<div style="padding-bottom:20px;text-align:center;color:#999">正在获取数据，请稍候...</div>');$.ajax({url:"/ajax_ajax.html?act=getSmsExprList",dataType:"json",cache:true,success:function(g){e.cityInfo=g;e.insertCitySelect();e.lock=false;},error:function(){$.alert2("发生网络错误，请稍候再试。");e.remove();}});}},provinceSelected:function(e){if(!parseInt(e)){return;}if(this.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","选择省",e]);}var b='<option value="0">请选择市</option>';for(var a in this.cityInfo[e].cityList){var d="";if(this.setting.defaultCityId&&a==this.setting.defaultCityId){d=' selected="selected"';var c=[a,this.cityInfo[e].cityList[a].cityName];}b+='<option value="'+a+'"'+d+">"+this.cityInfo[e].cityList[a].cityName+"</option>";}$("#_JS_sndSms_city_list_").html(b);this.selectedProvinceId=e;if(c){this.citySelected.apply(this,c);}},citySelected:function(d,b){if(!parseInt(d)){return;}if(this.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","选择市",d]);}var c=[];for(var a in this.cityInfo[this.selectedProvinceId].cityList[d].exprList){c.push({exprName:this.cityInfo[this.selectedProvinceId].cityList[d].exprList[a],exprId:a});}this.setting.exprInfo={cityName:b,exprList:c};this.selectedCityId=d;this.insertExprSelect();},getCaptcha:function(a){if(a){$._currentSendSmsBox.captchaImg.attr("src",a);}else{$.ajax({url:"/user/?act=get_captcha",cache:false,success:function(b){$._currentSendSmsBox.captchaImg.attr("src",b);}});}},remove:function(){if($._currentSendSmsBox&&$._currentSendSmsBox.dom){if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","关闭",new Date()-$._currentSendSmsBox.startTime]);}$($._currentSendSmsBox.dom).remove();$.hideMask();clearInterval($._currentSendSmsBox.timeLoop1);delete ($._currentSendSmsBox);}},send:function(){if(this.lock){return;}var d=parseInt($._currentSendSmsBox.inpt.val().replace(/\D/g,""),10);$._currentSendSmsBox.inpt.val(d||"");var c=$._currentSendSmsBox.captcha.val();if(!parseInt(this.exprId)){$._currentSendSmsBox.msg("请选择离您最近的体验馆。");if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","点击发送","未选择体验馆",this.exprId]);}return;}if(!d){$._currentSendSmsBox.msg("请输入正确手机号码。");if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","点击发送","手机号不正确",d]);}return;}if(!c||c=="验证码"||!$._currentSendSmsBox.captcha_flag){$._currentSendSmsBox.captcha_icon.removeClass("sms_captcha_success");$._currentSendSmsBox.captcha_icon.addClass("sms_captcha_error");$._currentSendSmsBox.msgBox.html("");if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","点击发送","验证码校验失败",c]);}return;}if($._currentSendSmsBox.setting.checkPhone&&!$._currentSendSmsBox.cellcaptcha_flag){$._currentSendSmsBox.msg("手机校验码有误。");if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","点击发送","手机校验码有误",$._currentSendSmsBox.setting.checkPhone]);}return;}window._ana&&window._ana.push(["trackEvent","testSendSmsStep","点击发送","验证通过，开发发送"]);$._currentSendSmsBox.msg("发送中...");$._currentSendSmsBox.btn.disabled=true;var e={};for(var a in $._currentSendSmsBox.setting){if(a!="captcha"&&a!=="captchaSrc"&&typeof $._currentSendSmsBox.setting[a]!="object"&&typeof $._currentSendSmsBox.setting[a]!="function"){e[a]=$._currentSendSmsBox.setting[a];}}var b="/ajax_ajax.html?act=send_expr_message&expr_id="+$._currentSendSmsBox.exprId+"&mobile="+d+"&captcha="+c+"&url="+encodeURIComponent(location.href);if($._currentSendSmsBox.setting.type=="get_prize_all"){b="/prize_normal.html?act=go&json=1&phone="+d+"&captcha="+c+"&expr_id="+this.exprId;}$.ajax({url:b,data:e,type:"get",dataType:"json",success:function(f){$._currentSendSmsBox.getCaptcha();$._currentSendSmsBox._reset_captcha();if(f.error=="0"||f.code=="success"){window._ana&&window._ana.push(["trackEvent","sendSms_"+$._currentSendSmsBox.setting.type,"success",d,/^([9]+){3,}$/.test($._currentSendSmsBox.exprId)?"unset":$._currentSendSmsBox.exprId]);if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","发送结果","成功",f.msg]);}window._gaq=window._gaq||[];_gaq.push(["_trackEvent","sms",$._currentSendSmsBox.setting.type,($.cookie("MLLSEO")+"_undefined").split("_")[0]+($._currentSendSmsBox.setting.click?("_"+$._currentSendSmsBox.setting.click):"")]);if($._currentSendSmsBox.setting.autoClose){f.msg+="<br />本窗口将在2秒后自动关闭。";setTimeout($._currentSendSmsBox.remove,4000);}$._currentSendSmsBox.msg(f.msg,true);if($._currentSendSmsBox.setting.type=="get_prize_all"){$.ajax({url:"/prize_normal.html?act=finish&pid="+f.pid+"&prize_id="+$._currentSendSmsBox.setting.prize_id+"&expr_id="+$._currentSendSmsBox.exprId,csche:false});}if($._currentSendSmsBox.setting.success){$._currentSendSmsBox.setting.success(f);}}else{window._ana&&window._ana.push(["trackEvent","sendSms_"+$._currentSendSmsBox.setting.type,"error",d,/^([9]+){3,}$/.test($._currentSendSmsBox.exprId)?"unset":$._currentSendSmsBox.exprId,f.msg]);if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","发送结果","失败",f.msg]);}$._currentSendSmsBox.msg(f.msg);$._currentSendSmsBox.btn.disabled=false;}},error:function(){window._ana&&window._ana.push(["trackEvent","sendSms_"+$._currentSendSmsBox.setting.type,"error",d,/^([9]+){3,}$/.test($._currentSendSmsBox.exprId)?"unset":$._currentSendSmsBox.exprId,"netError"]);if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","发送结果","网络错误",argumrnts[1]]);}$._currentSendSmsBox.getCaptcha();$._currentSendSmsBox._reset_captcha();$._currentSendSmsBox.msg("发送失败");$._currentSendSmsBox.btn.disabled=false;}});},msg:function(b,c){var a=c?"-42":"-27";b='<span style="display:inline-block;vertical-align:middle;width:14px;height:14px;background:url('+this.bg+") "+a+'px -65px;margin-right:6px;"></span><span style="vertical-align:middle;color:#c9033b;background:#fff;">'+b+"</span>";$._currentSendSmsBox.msgBox.html(b);},keyPress:function(a){a=a||window.event;if(a.keyCode==13){$._currentSendSmsBox.send();}},phoneOnBlur:function(a){if($._currentSendSmsBox.inTest&&a&&a.value){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","手机号输入",a.value]);}},_reset_captcha:function(){$._currentSendSmsBox.captcha.val("");$._currentSendSmsBox.captcha_flag=false;$._currentSendSmsBox.captcha_icon[0].className="_check_icon";},hiddenPhone:function(){var a=$("#_JS_sndSms_input_").get(0).value;if(/^[1][358][0-9]{9}$/.test(a)){$._currentSendSmsBox.setting.pNumber=a;}if(/^[1][358][0-9]{9}$/.test($._currentSendSmsBox.setting.pNumber)){$._currentSendSmsBox.msgBox.html("");$("#_JS_sndSms_input_").get(0).value=$._currentSendSmsBox.setting.pNumber;$._currentSendSmsBox.setting.flag=1;}else{$._currentSendSmsBox.msg("请输入正确手机号码。");}},getCellCaptcha:function(){var c=this;if(this.setting.flag==1){var b=$("#_JS_sndSms_captcha_").get(0).value;if(b.length!=4){$._currentSendSmsBox.msg("您输入的验证码不正确。");$._currentSendSmsBox.getCaptcha();}else{if($._currentSendSmsBox.captcha_flag){var a=this.setting.pNumber;$._currentSendSmsBox.msgBox.html("");$.ajax({url:"/interface.html?act=get_mobile_captcha&captcha="+b+"&mobile="+a+(c.setting.type=="getPrize"?"&from_type=choujiang":"")+($._currentSendSmsBox.exprId?("&expr_id="+$._currentSendSmsBox.exprId):""),type:"GET",dataType:"json",success:function(e){if(e.error==0){$("#_JS_sndSms_prz_btn2_").get(0).style.display="none";$("#_JS_sndSms_prz_tishiA").get(0).style.color="#999999";var d=$("#_JS_sndSms_input_").get(0).value;$("#_JS_sndSms_prz_tishiA").get(0).innerHTML="校验码已发送至手机"+d+"请查收";$("#_JS_sndSms_prz_btn6_").get(0).style.display="none";$("#_JS_sndSms_prz_tishiA").get(0).style.display="inline-block";$._currentSendSmsBox.getNewCaptcha();}else{var f=e.msg||"手机校验码发送失败！";$._currentSendSmsBox.msg(f);$._currentSendSmsBox.getCaptcha();$._currentSendSmsBox._reset_captcha();}}});}}}},getNewCaptcha:function(){var a=$("#_JS_sndSms_prz_btn5_").get(0),b=$("#_JS_sndSms_prz_btn6_").get(0);a.style.display="inline-block";$._currentSendSmsBox._mobile_captcha_times_left=$._currentSendSmsBox._mobile_captcha_times_limit_g;a.innerHTML="("+$._currentSendSmsBox._mobile_captcha_times_limit_g+"秒后) 重新获取短信";$._currentSendSmsBox.timeLoop2=setInterval(function(){a.innerHTML="("+$._currentSendSmsBox._mobile_captcha_times_left+"秒后) 重新获取短信";$._currentSendSmsBox._mobile_captcha_times_left--;if($._currentSendSmsBox._mobile_captcha_times_left<=0){clearInterval($._currentSendSmsBox.timeLoop2);$._currentSendSmsBox._mobile_captcha_times_left=$._currentSendSmsBox._mobile_captcha_times_limit_g;a.style.display="none";b=$("#_JS_sndSms_prz_btn6_").get(0);b.style.display="inline-block";$._currentSendSmsBox.getCaptcha();$._currentSendSmsBox._reset_captcha();$("#_JS_sndSms_prz_tishiA").get(0).style.display="none";}},1000,a);},getCaptchaAgin:function(){$._currentSendSmsBox.getCellCaptcha();},value_null:function(c){var d=$("#_JS_sndSms_prz_btn2_").get(0),b=$("#_JS_sndSms_prz_btn4_").get(0),a=$("#_JS_sndSms_prz_btn5_").get(0),e=$("#_JS_sndSms_prz_tishiA").get(0);if(a.innerHTML=="(0秒后) 重新获取短信"||a.innerHTML=="(-1秒后) 重新获取短信"){$._currentSendSmsBox.setting.pNumber=0;$._currentSendSmsBox.setting.flag=0;d.style.display="inline-block";a.style.display="none";e.style.display="none";$._currentSendSmsBox.msgBox.html("");}if(a.style.display=="inline-block"){$("#_JS_sndSms_prz_cellcaptcha_").get(0).value="";}},checkCellCaptcha:function(){var a=$("#_JS_sndSms_prz_cellcaptcha_").get(0).value;if(a.length!=6){$._currentSendSmsBox.msg("校验码有误。");$._currentSendSmsBox.cellcaptcha_flag=false;return;}else{$._currentSendSmsBox.msgBox.html("");$._currentSendSmsBox.cellcaptcha_flag=true;$._currentSendSmsBox.setting.checkPhone=a;if($._currentSendSmsBox.inTest){window._ana&&window._ana.push(["trackEvent","testSendSmsStep","手机证码填写成功",a]);}}},setExprMap:function(){if(this.inTest&&this.exprId>0){$.ajax({url:"/mll_api/api/exper?expr_id="+this.exprId,dataType:"json",success:function(a){if(a&&a[0]){var b="http://api.map.baidu.com/staticimage?width=220&height=200&center="+a[0].position+"&markers="+a[0].position+"&zoom=11&copyright=1";$("#_JS_sndSms_map_").html('<img title="'+a[0].addr+'" alt="'+a[0].addr+'" src="'+b+'" width="220" height="200" />');}}});}}};$.sendSms.prototype.init.prototype=$.sendSms.prototype;
/*LDZ:2014-05-21 09:25:59*/