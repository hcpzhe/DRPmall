$(function(a){a.fn.tabs=function(){return this.each(function(){var e=a(this);var d=e.find(".title");var b=e.find(".tabItem");var c=e.find(".more");d.each(function(f){a(this).click(function(){a(this).parent().find(".title").removeClass("current");
a(this).parent().next(".tabConts").children(".tabItem").hide();a(this).addClass("current");a(this).parent().next(".tabConts").children(".tabItem").eq(f).show();
c.addClass("none").eq(f).removeClass("none");});});});};userWin={delWin:function(b){userWin.callFn(b);},callFn:function(b){if(!b){return;}userWin.createMask();
userWin.createElement(520,userWin.createContent(b));},createMask:function(){var f=a("#JS_mask"),c=a("#JS_userBox");if(f){f.remove();}if(c){c.remove();}var b=a('<div  id="JS_mask" class="c-mask"></div>'),d=(document.body.scrollHeight>=window.screen.availHeight)?document.body.scrollHeight:window.screen.availHeight;
b.css({height:d+"px"});var e=a('<div id="JS_userBox" class="JS_userBox"></div>');a("body").append(b);a("body").append(e);},createElement:function(b,d){var c=a('<div class="c-container"></div>');
c.css({width:b+"px"});c.append(a(d));a("#JS_userBox").append(c);},createContent:function(c){var b='<div class="title"><span>取消订单</span><a href="javascript:;" class="closeBtn" onclick="userWin.closeDialog();return false;"></a></div><div class="body delOrder"><form action="/user/?act=cancel_order" method="post" id="order_del_form" name="order_del_form"><p class="f18 red">请你选择取消该订单的原因？以改进我们的服务</p><table class="mt10"><tr><td><label><input type="radio" name="resoncon" value="现在不想购买"/>现在不想购买</label></td><td><label><input type="radio" name="resoncon" value="商品价格比较贵"/>商品价格比较贵</label></td></tr><tr><td><label><input type="radio" name="resoncon" value="有商品缺货"/>有商品缺货</label></td><td><label><input type="radio" name="resoncon" value="支付不成功"/>支付不成功</label></td></tr><tr><td><label><input type="radio" name="resoncon" value="更新或添加新商品"/>更新或添加新商品</label></td><td><label><input type="radio" name="resoncon" value="错误或重复下单"/>错误或重复下单</label></td></tr><tr><td><label><input type="radio" name="resoncon" value="红包或优惠劵使用不成功"/>红包或优惠劵使用不成功</label></td><td><label><input type="radio" name="resoncon" value="1" id="other" />其他</label></td></tr></table><textarea name="other_reason" id="other_reason"></textarea><input type="hidden" value="'+c+'" id="order_id" name="order_id" /><div class="btnBox"><a href="javascript:;" class="btn_b cancel_btn" onclick="userWin.submitForm();return false;"><span>取消订单</span></a> <a href="javascript:;" class="btn_cancel" onclick="userWin.closeDialog();return false;"><span>关闭窗口</span></a></div></form></div>';
return b;},createLoading:function(){var b='<div class="tLoading">加载中...</div>';return b;},closeDialog:function(){var c=a("#JS_mask"),b=a("#JS_userBox");
c.remove();b.remove();if(typeof callBack=="function"){callBack();}},submitForm:function(){a("#JS_userBox form#order_del_form").submit();}};addressWin={showBox:function(d){var b=a(d).outerWidth();
var c=a(d).outerHeight();a("#overlay").show();a(d).show();a(d).css({"margin-left":-(b/2),"margin-right":-(c/2)});},hideBox:function(b){a("#overlay").hide();
a(b).hide();}};a.fn.slidePicLong=function(g,f,d,e,c,b){return this.each(function(){var o=a(this);var h=o.find("ul");var k=o.find(".prev");var i=o.find(".next");
var n=h.children("li");var p=n.outerWidth()+c;var m=n.length;if(m<=e){k.hide();i.hide();return 0;}else{k.show();i.show();}if(!o.children(".container")){h.wrap('<div class="container"></div>');
}h.css({width:p*m});function l(q){switch(q){case"next":h.animate({"margin-left":-p},d,function(){h.css("margin-left","0");h.find("li:first").appendTo(h);
});break;case"prev":h.css({"margin-left":-p});h.find("li:last").prependTo(h);h.animate({marginLeft:0},d);break;}}function j(){g=setInterval(function(){l("next");
},f);}k.click(function(){clearInterval(g);l("prev");j();return false;});i.click(function(){clearInterval(g);l("next");j();return false;});h.hover(function(){clearInterval(g);
},function(){j();});if(g){j();}});};});function save_agree(a){if(!a){return;}var b=a.getAttribute("data-id");if(b==""||b=="undefind"){return;}M.ajax({url:"/user/?act=save_agreen_refund_mone&id="+b,dataType:"json",success:function(c){alert(c.msg);
location.reload();},error:function(){alert("网络错误！");}});}function closeHideMask(a){M.closeLightBox(a);M.hideMask();}function agree_html(c,d){var a="",b=document.createElement("div");
b.className="JS_userBox";b.id="JS_lightBox_55";a+='<div class="title"><span>确认退款请同意退款协议</span><a href="javascript:;" onclick="closeHideMask(55)" title="关闭" class="closeBtn"></a></div><div class="body"><div class="content">';
a+="<p>"+c+"</p>";a+='<p class="buttons"><a href="javascript:void(0)" class="btn_s" data-id="'+d+'" onclick="save_agree(this)"><span>确定</span></a>';a+='<a href="javascript:void(0)" onclick="closeHideMask(55)"><span>取消</span></a></p>';
a+="</div></div></div>";a+="</div>";b.innerHTML=a;return b;}function agree_refund(a){if(a==""||a=="undefind"){return false;}M.ajax({url:"/user/?act=get_agreen_refund_mone&id="+a,dataType:"json",success:function(b){M.showMask();
document.body.appendChild(agree_html(b.msg,a));var c=M.$("#JS_lightBox_55");c.style.marginTop="-"+c.offsetHeight/2+"px";},error:function(){alert("网络错误！");
}});}function report_judge_html(c){var a="",b=document.createElement("div");b.className="JS_userBox";b.id="JS_lightBox_56";a+='<div class="title"><span>请填写理由！</span><a href="javascript:;" onclick="closeHideMask(56)" title="关闭" class="closeBtn"></a></div><div class="body"><div class="content">';
a+='<p><textarea id="JS_judge_reason" rows="4" onclick="this.value=\'\'">请填写您的理由!</textarea></p>';a+='<p class="buttons"><a href="javascript:void(0)" class="btn_s" data-id="'+c+'" onclick="save_judge(this)"><span>确定</span></a>';
a+='<a href="javascript:void(0)" onclick="closeHideMask(56)"><span>取消</span></a></p>';a+="</div></div></div>";a+="</div>";b.innerHTML=a;return b;}function save_judge(a){if(!a){return;
}var c=a.getAttribute("data-id"),b=M.$("#JS_judge_reason").value;if(c==""||c=="undefind"){return;}if(b==""||b=="请填写您的理由!"){alert("请先填写您申报纠纷的原因！");return false;
}M.ajax({url:"/user/?act=report_judge&id="+c+"&judge_reason="+b,dataType:"json",success:function(d){location.reload();},error:function(){alert("网络错误！");
}});}function report_judge(b){if(b==""||b=="undefind"){return;}M.showMask();document.body.appendChild(report_judge_html(b));var a=M.$("#JS_lightBox_56");
a.style.marginTop="-"+a.offsetHeight/2+"px";}function refund_goods_html(c){var a="",b=document.createElement("div");b.className="JS_userBox";b.id="JS_lightBox_56";
a+='<div class="title"><span>请填写理由！</span><a href="javascript:;" onclick="closeHideMask(56)" title="关闭" class="closeBtn"></a></div><div class="body"><div class="content">';
a+='<p><textarea id="JS_judge_reason" rows="4" onclick="this.value=\'\'">请填写您的理由!</textarea></p>';a+='<p class="buttons"><a href="javascript:void(0)" class="btn_s" data-id="'+c+'" onclick="save_refund(this)"><span>确定</span></a>';
a+='<a href="javascript:void(0)" onclick="closeHideMask(56)"><span>取消</span></a></p>';a+="</div></div></div>";a+="</div>";b.innerHTML=a;return b;}function save_refund(a){if(!a){return;
}var c=a.getAttribute("data-id"),b=M.$("#JS_judge_reason").value;if(c==""||c=="undefind"){return;}if(b==""||b=="请填写您的理由!"){alert("请先填写您退换货的原因！");return false;
}M.ajax({url:"/user/?act=apply_refund_goods&order_id="+c+"&reason="+b,dataType:"json",success:function(d){alert(d.msg);location.reload();},error:function(){alert("网络错误！");
}});}function refund_goods(b){if(b==""||b=="undefind"){return;}M.showMask();document.body.appendChild(refund_goods_html(b));var a=M.$("#JS_lightBox_56");
a.style.marginTop="-"+a.offsetHeight/2+"px";}function confirm_received(b){if(!b){return;}var a=confirm("你确认已经收到货物了吗？");if(a==false){return;}M.ajax({url:"/user/?act=affirm_received&order_id="+b,dataType:"json",success:function(c){alert(c.msg);
location.reload();},error:function(){alert("网络错误！");}});}var orderMagage={orderRefund:function(a){if(a==""||a=="undefined"){return;}M.ajax({url:"/user/",type:"post",data:{act:"balance_show",order_id:a,____:new Date().getTime()},dataType:"json",success:function(c){if(c.error==0||c.error==1){var b="";
b+="<div>订单金额：<span style=\"font-family:'微软雅黑'\">&yen;</span>";b+=c.a_pay;b+="</div><div>已付金额：<span style=\"font-family:'微软雅黑'\">&yen;</span>";b+=c.s_pay;
b+='</div><div>退款金额：<span style="font-family:\'微软雅黑\'">&yen;</span><span style="color:red">';b+=c.refund;b+="</span></div>";if(c.error==1){if(c.finish==1){b+="<div style=\"position:relative; margin:5px 0 0 0; text-align:left; width: 330px; font-family:'微软雅黑'; font-size:16px\">余款退款成功！</div>";
}else{b+="<div style=\"position:relative; margin:5px 0 0 0; text-align:left; width: 330px; font-family:'微软雅黑'; font-size:16px\">余款退还中</div>";}M.alert(b);
}else{b+="<div style=\"position:relative; margin:5px 0 0 0; text-align:left; width: 330px; font-family:'微软雅黑'; font-size:16px\">确定退还订单余额？</div>";M.confirm(b,{onOk:function(){orderMagage.ajaxPostRefund(a);
}});}}else{if(c.msg){alert(c.msg);}else{alert("网络错误！请稍后刷新页面重试!");}}},error:function(){alert("网络错误！请稍后刷新页面重试!");}});},ajaxPostRefund:function(a){if(!a){return;
}M.ajax({url:"/user/",type:"post",data:{act:"balance_show",order_id:a,submit:1,____:new Date().getTime()},dataType:"json",success:function(b){if(b.error==0){location.reload();
}else{if(b.msg){alert(b.msg);}else{alert("网络错误！请稍后刷新页面重试!");}}},error:function(){alert("网络错误！请稍后刷新页面重试!");}});}};
/*GERMANY:2013-12-03 22:34:36*/